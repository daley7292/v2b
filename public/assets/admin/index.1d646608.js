import{v as te,j as we,U as Ve,k as Te,_ as Ce}from"./index.931e29e8.js";/* empty css              *//* empty css               *//* empty css              *//* empty css              *//* empty css                *//* empty css              *//* empty css               *//* empty css               *//* empty css               */import{d as ne,f as T,r as L,o as se,aZ as de,C as m,D as z,aI as o,aH as e,aE as _,u as a,aF as h,G as M,aN as i,aM as r,aK as R,aJ as q,b2 as re,b7 as xe,b8 as Ne,b9 as Se,bS as Ue,aX as ue,bB as Ie,bC as ze,b3 as pe,b5 as je,c as De,w as Pe,F as Ee,aW as oe,a6 as $e,be as Be,b4 as Fe,aV as Me,bO as Qe,I as Ge,ag as Oe,ae as Le,af as Re,bE as qe,b6 as Ae,aY as He,bc as Je,bd as We}from"./arco.d070d3bc.js";import{u as Xe}from"./loading.50473042.js";import{c as ae}from"./cloneDeep.47777689.js";import"./sortable.esm.3bac4038.js";/* empty css               *//* empty css               */import{Q as Ke}from"./router.739b215b.js";import{d as Ye,Q as Ze,S as eo,n as le,N as oo,U as ao,C as lo,D as to,a as no}from"./node.75130ad4.js";import{Q as so}from"./permission.ca5b32e4.js";import"./chart.dd5d83bb.js";import"./vue.02dbc53f.js";const ro={style:{"margin-right":"5px"}},uo=ne({__name:"node-form",props:["channelType","data","parentServer"],emits:["close"],setup(D,{emit:A}){const C=D,{t:s}=te.exports.useI18n(),E=T([]),y=async()=>{const{data:v}=await Ze();E.value=v};T(null),T(!1);const b=v=>v.includes(C.channelType),l=L(Ye),U=C.data,H=C.parentServer,$=C.channelType,Q=()=>{A("close")},J=()=>{C.channelType==="hysteria"?l.insecure=0:l.insecure=null,eo(l).then(v=>{Q()})},G=T(),W=()=>{Ke().then(v=>{G.value=v.data})};return se(()=>{y(),Object.keys(U).forEach(v=>{U[v]==null?l[v]="":l[v]=U[v]}),W()}),(v,n)=>{const g=re,f=xe,V=Ne,j=Se,B=Ue,F=ue,X=de("router-link"),c=Ie,w=ze,O=pe,K=Ve,N=je;return m(),z("div",null,[o(N,{layout:"vertical",model:l,onSubmit:J},{default:e(()=>[b(["shadowsocks","vmess","trojan","hysteria"])?(m(),_(j,{key:0},{default:e(()=>[o(V,{span:13},{default:e(()=>[o(f,{field:"name",label:a(s)("node.form.name")},{default:e(()=>[o(g,{modelValue:l.name,"onUpdate:modelValue":n[0]||(n[0]=t=>l.name=t),placeholder:a(s)("node.form.name.placeholder")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),o(V,{span:10,offset:1},{default:e(()=>[o(f,{field:"rate",label:a(s)("node.form.rate")},{default:e(()=>[o(g,{modelValue:l.rate,"onUpdate:modelValue":n[1]||(n[1]=t=>l.rate=t),placeholder:a(s)("node.form.rate.placeholder")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})]),_:1})):h("",!0),b(["shadowsocks","vmess","trojan","hysteria"])?(m(),_(f,{key:1,field:"tags",label:a(s)("node.form.tags")},{default:e(()=>[o(B,{"default-value":[],modelValue:l.tags,"onUpdate:modelValue":n[2]||(n[2]=t=>l.tags=t),style:{width:"100%"},placeholder:a(s)("node.form.tags.placeholder"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])):h("",!0),b(["shadowsocks","vmess","trojan","hysteria"])?(m(),_(f,{key:2},{label:e(()=>[M("span",null,i(a(s)("node.form.permission_group")),1),o(X,{to:"/"+a(we)+"/server/permission_group"},{default:e(()=>[o(F,{type:"text"},{default:e(()=>[r(i(a(s)("node.form.add_permission_group")),1)]),_:1})]),_:1},8,["to"])]),default:e(()=>[o(O,{direction:"vertical",size:"large"},{default:e(()=>[o(w,{"default-value":[],style:{width:"460px"},modelValue:l.group_id,"onUpdate:modelValue":n[3]||(n[3]=t=>l.group_id=t),scrollbar:!0,multiple:""},{default:e(()=>[(m(!0),z(R,null,q(E.value,(t,d)=>(m(),z("div",{key:d},[o(c,{value:t.id+""},{default:e(()=>[r(i(t.name),1)]),_:2},1032,["value"])]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})):h("",!0),b(["shadowsocks","trojan","hysteria"])?(m(),_(f,{key:3,field:"",label:a(s)("node.form.address")},{default:e(()=>[o(g,{modelValue:l.host,"onUpdate:modelValue":n[4]||(n[4]=t=>l.host=t),placeholder:a(s)("node.form.address.placeholder")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])):h("",!0),b(["vmess"])?(m(),_(j,{key:4},{default:e(()=>[o(V,{span:11},{default:e(()=>[o(f,{label:a(s)("node.form.address")},{default:e(()=>[o(g,{modelValue:l.host,"onUpdate:modelValue":n[5]||(n[5]=t=>l.host=t),placeholder:a(s)("node.form.connection_address")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),o(V,{offset:"2",span:11},{default:e(()=>[o(f,{label:a(s)("node.form.tls")},{default:e(()=>[o(w,{modelValue:l.tls,"onUpdate:modelValue":n[6]||(n[6]=t=>l.tls=t)},{default:e(()=>[o(c,{value:0},{default:e(()=>[r(i(a(s)("node.form.tls.not_supported")),1)]),_:1}),o(c,{value:1},{default:e(()=>[r(i(a(s)("node.form.tls.supported")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1})):h("",!0),b(["shadowsocks","vmess"])?(m(),_(j,{key:5},{default:e(()=>[o(V,{span:11},{default:e(()=>[o(f,{label:a(s)("node.form.connection_port")},{default:e(()=>[o(g,{modelValue:l.port,"onUpdate:modelValue":n[7]||(n[7]=t=>l.port=t),placeholder:a(s)("node.form.connection_port.placeholder")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),o(V,{offset:"2",span:11},{default:e(()=>[o(f,{label:a(s)("node.form.server_port")},{default:e(()=>[o(g,{modelValue:l.server_port,"onUpdate:modelValue":n[8]||(n[8]=t=>l.server_port=t),placeholder:a(s)("node.form.server_port.placeholder")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})]),_:1})):h("",!0),b(["trojan","hysteria"])?(m(),_(j,{key:6},{default:e(()=>[o(V,{span:8},{default:e(()=>[o(f,{label:a(s)("node.form.connection_port")},{default:e(()=>[o(g,{modelValue:l.port,"onUpdate:modelValue":n[9]||(n[9]=t=>l.port=t),placeholder:a(s)("node.form.connection_port.placeholder")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),o(V,{span:7,offset:1},{default:e(()=>[o(f,{label:a(s)("node.form.server_port")},{default:e(()=>[o(g,{modelValue:l.server_port,"onUpdate:modelValue":n[10]||(n[10]=t=>l.server_port=t),placeholder:a(s)("node.form.server_port.placeholder")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),o(V,{span:7,offset:1},{default:e(()=>[o(f,{label:a(s)("node.form.allow_insecure")},{default:e(()=>[o(w,{"default-value":0,modelValue:l.allow_insecure,"onUpdate:modelValue":n[11]||(n[11]=t=>l.allow_insecure=t)},{default:e(()=>[o(c,{value:0},{default:e(()=>[r(i(a(s)("node.form.allow_insecure.no")),1)]),_:1}),o(c,{value:1},{default:e(()=>[r(i(a(s)("node.form.allow_insecure.yes")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1})):h("",!0),b(["trojan","hysteria"])?(m(),_(f,{key:7,label:a(s)("node.form.server_name")},{default:e(()=>[o(g,{modelValue:l.server_name,"onUpdate:modelValue":n[12]||(n[12]=t=>l.server_name=t),placeholder:a(s)("node.form.server_name.placeholder")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])):h("",!0),b(["vmess"])?(m(),_(f,{key:8,label:a(s)("node.form.transport_protocol")},{default:e(()=>[o(w,{modelValue:l.network,"onUpdate:modelValue":n[13]||(n[13]=t=>l.network=t)},{default:e(()=>[o(c,{value:"tcp"},{default:e(()=>[r("TCP")]),_:1}),o(c,{value:"ws"},{default:e(()=>[r("WebSocket")]),_:1}),o(c,{value:"grpc"},{default:e(()=>[r("GRPC")]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"])):h("",!0),b(["shadowsocks"])?(m(),_(f,{key:9,label:a(s)("node.form.encryption_algorithm")},{default:e(()=>[o(w,{"default-value":"aes-128-gcm",modelValue:l.cipher,"onUpdate:modelValue":n[14]||(n[14]=t=>l.cipher=t)},{default:e(()=>[o(c,{value:"aes-128-gcm"},{default:e(()=>[r("aes-128-gcm")]),_:1}),o(c,{value:"aes-192-gcm"},{default:e(()=>[r("aes-192-gcm")]),_:1}),o(c,{value:"aes-256-gcm"},{default:e(()=>[r("aes-256-gcm")]),_:1}),o(c,{value:"chacha20-ietf-poly1305"},{default:e(()=>[r("chacha20-ietf-poly1305")]),_:1}),o(c,{value:"2022-blake3-aes-128-gcm"},{default:e(()=>[r("2022-blake3-aes-128-gcm")]),_:1}),o(c,{value:"2022-blake3-aes-256-gcm"},{default:e(()=>[r("2022-blake3-aes-256-gcm")]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"])):h("",!0),b(["shadowsocks"])?(m(),_(f,{key:10,label:a(s)("node.form.obfuscation")},{default:e(()=>[o(w,{"default-value":"",modelValue:l.obfs,"onUpdate:modelValue":n[15]||(n[15]=t=>l.obfs=t)},{default:e(()=>[o(c,{value:""},{default:e(()=>[r(i(a(s)("node.form.obfuscation.none")),1)]),_:1}),o(c,{value:"http"},{default:e(()=>[r("http")]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"])):h("",!0),l.obfs?(m(),_(j,{key:11},{default:e(()=>[o(V,{span:11},{default:e(()=>[o(f,null,{default:e(()=>[o(g,{modelValue:l.obfs_settings.path,"onUpdate:modelValue":n[16]||(n[16]=t=>l.obfs_settings.path=t),placeholder:a(s)("node.form.path")},null,8,["modelValue","placeholder"])]),_:1})]),_:1}),o(V,{offset:"2",span:11},{default:e(()=>[o(f,null,{default:e(()=>[o(g,{modelValue:l.obfs_settings.host,"onUpdate:modelValue":n[17]||(n[17]=t=>l.obfs_settings.host=t),placeholder:a(s)("node.form.host")},null,8,["modelValue","placeholder"])]),_:1})]),_:1})]),_:1})):h("",!0),b(["hysteria"])?(m(),_(f,{key:12,label:a(s)("node.form.upstream_bandwidth")},{default:e(()=>[o(g,{modelValue:l.up_mbps,"onUpdate:modelValue":n[18]||(n[18]=t=>l.up_mbps=t),placeholder:a(s)("node.form.upstream_bandwidth.placeholder")},{append:e(()=>[r(" Mbps ")]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])):h("",!0),b(["hysteria"])?(m(),_(f,{key:13,label:a(s)("node.form.downstream_bandwidth")},{default:e(()=>[o(g,{modelValue:l.down_mbps,"onUpdate:modelValue":n[19]||(n[19]=t=>l.down_mbps=t),placeholder:a(s)("node.form.downstream_bandwidth.placeholder")},{append:e(()=>[r(" Mbps ")]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])):h("",!0),b(["shadowsocks","vmess","trojan","hysteria"])?(m(),_(f,{key:14},{label:e(()=>[M("span",ro,i(a(s)("node.form.parent_node")),1),o(K,{size:16})]),default:e(()=>[o(w,{"default-value":"",modelValue:l.parent_id,"onUpdate:modelValue":n[20]||(n[20]=t=>l.parent_id=t)},{default:e(()=>[o(c,{value:""},{default:e(()=>[r(i(a(s)("node.form.parent_node.none")),1)]),_:1}),(m(!0),z(R,null,q(a(H),(t,d)=>(m(),z("div",{key:d},[t.id!=l.id&&a($)==t.type?(m(),_(c,{key:0,value:t.id},{default:e(()=>[r(i(t.name),1)]),_:2},1032,["value"])):h("",!0)]))),128))]),_:1},8,["modelValue"])]),_:1})):h("",!0),b(["shadowsocks","vmess","trojan","hysteria"])?(m(),_(f,{key:15,label:a(s)("node.form.route_group")},{default:e(()=>[o(w,{"default-value":"",modelValue:l.route_id,"onUpdate:modelValue":n[21]||(n[21]=t=>l.route_id=t),placeholder:a(s)("node.form.route_group.desc"),multiple:""},{default:e(()=>[(m(!0),z(R,null,q(G.value,(t,d)=>(m(),_(c,{key:d,value:t.id+""},{default:e(()=>[r(i(t.remarks),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])):h("",!0),o(f,null,{default:e(()=>[o(O,null,{default:e(()=>[o(F,{type:"dashed",onClick:Q},{default:e(()=>[r(i(a(s)("button.cancel")),1)]),_:1}),o(F,{"html-type":"submit",type:"primary"},{default:e(()=>[r(i(a(s)("node.form.submit")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])])}}}),po=D=>(Je("data-v-608eb392"),D=D(),We(),D),mo={class:"container"},io={style:{"margin-bottom":"15px"}},co=po(()=>M("span",null,":",-1)),fo={name:"ServerNode"},_o=ne({...fo,setup(D){const A=()=>({number:"",name:"",contentType:"",filterType:"",createdTime:[],status:""}),C=["shadowsocks","vmess","trojan","hysteria"],{loading:s,setLoading:E}=Xe(!0),{t:y}=te.exports.useI18n(),b=T([]),l=T([]);T(A());const U=T([]),H=T([]);let $=L({});const Q=()=>{so().then(d=>{d.data&&d.data.forEach(u=>{$[u.id+""]=u.name})})},J=d=>{b.value=d;let u={};d.forEach((x,I)=>{u[x.type]||(u[x.type]={}),u[x.type][x.id]=I}),oo(u)},G=d=>{if(d){let u=[];l.value.forEach(I=>{let k=!0;Object.keys(I).forEach(S=>{k&&(I[S]+"").includes(d)&&(k=!1,u.push(I))})}),b.value=u}else b.value=l.value},W=T("medium"),v=T(!1),n=L({channelType:""}),g=d=>{n.channelType=d;let u=le;u.type=d,B.value=u,v.value=!0},f=()=>{v.value=!1,N()},V=d=>{B.value=d,n.channelType=d.type,v.value=!0},j=d=>{ao({type:d.type,id:d.id,show:d.show==1?0:1}).then(u=>{N()})},B=T(le),F=d=>{lo({id:d.id,type:d.type}).then(u=>{u.data&&(oe.success({content:y("nodeTable.message.copy.success")}),N())})},X=d=>{to({id:d.id,type:d.type}).then(u=>{u.data&&(oe.success({content:y("nodeTable.message.delete.success")}),N())})},c={current:1,pageSize:100},w=L({...c,showTotal:!0,showJumper:!0,showPageSize:!0,pageSizeOptions:[100,500,1e3]}),O=d=>{w.pageSize=d,c.pageSize=d,N({...c,pageSize:d})},K=De(()=>[{title:y("nodeTable.columns.id"),dataIndex:"id",slotName:"id",width:80},{title:y("nodeTable.columns.show"),slotName:"show"},{title:y("nodeTable.columns.name"),dataIndex:"name",slotName:"name"},{title:y("nodeTable.columns.address"),slotName:"address"},{title:y("nodeTable.columns.online"),slotName:"online"},{title:y("nodeTable.columns.rate"),slotName:"rate"},{title:y("nodeTable.columns.group_id"),slotName:"group_id"},{title:y("nodeTable.columns.operations"),dataIndex:"operations",slotName:"operations"}]),N=async d=>{d||(d={...c}),E(!0);try{const{data:u}=await no(d);b.value=u,l.value=u,w.total=u.length}catch{}finally{E(!1)}},t=d=>{N({...c,current:d})};return N(c),Pe(()=>K.value,d=>{U.value=ae(d),U.value.forEach((u,x)=>{u.checked=!0}),H.value=ae(U.value)},{deep:!0,immediate:!0}),se(()=>{Q()}),(d,u)=>{const x=de("Breadcrumb"),I=$e,k=ue,S=Be,Y=Fe,me=re,Z=pe,ie=Me,ce=Te,ee=Qe,fe=Ge,_e=Oe,be=Le,ye=Re,he=qe,ve=Ae,ge=He;return m(),z("div",mo,[o(x,{items:["menu.server","menu.server.node"]},null,8,["items"]),o(ve,null,{default:e(()=>[M("div",io,[o(Z,null,{default:e(()=>[o(Y,{trigger:"hover",position:"bl"},{content:e(()=>[o(S,null,{default:e(()=>[o(k,{type:"primary",status:"success",style:{"background-color":"rgb(72, 152, 81)"},size:"small",onClick:u[0]||(u[0]=p=>g("shadowsocks"))},{default:e(()=>[r("Shadowsocks")]),_:1})]),_:1}),o(S,null,{default:e(()=>[o(k,{type:"primary",status:"danger",size:"small",style:{"background-color":"rgb(203, 49, 128)"},onClick:u[1]||(u[1]=p=>g("vmess"))},{default:e(()=>[r("Vmess")]),_:1})]),_:1}),o(S,null,{default:e(()=>[o(k,{type:"primary",status:"warning",size:"small",style:{"background-color":"rgb(234, 184, 84)"},onClick:u[2]||(u[2]=p=>g("trojan"))},{default:e(()=>[r("Trojan")]),_:1})]),_:1}),o(S,null,{default:e(()=>[o(k,{type:"primary",style:{"background-color":"rgb(26, 26, 26)"},size:"small",onClick:u[3]||(u[3]=p=>g("hysteria"))},{default:e(()=>[r("Hysteria ")]),_:1})]),_:1})]),default:e(()=>[o(k,{type:"outline",size:"medium"},{icon:e(()=>[o(I)]),_:1})]),_:1}),o(me,{style:{width:"160px"},placeholder:a(y)("nodeTable.search.placeholder"),onInput:G},null,8,["placeholder"])]),_:1})]),o(he,{"row-key":"id",loading:a(s),pagination:w,columns:U.value,data:b.value,bordered:!1,size:W.value,onPageChange:t,onPageSizeChange:O,onChange:J,draggable:{type:"handle",width:40}},{index:e(({rowIndex:p})=>[r(i(p+1+(w.current-1)*w.pageSize),1)]),id:e(({record:p})=>[p.type===C[0]?(m(),_(k,{key:0,type:"primary",status:"success",style:{"background-color":"rgb(72, 152, 81)"},size:"mini"},{default:e(()=>[r(i(p.id),1)]),_:2},1024)):h("",!0),p.type===C[1]?(m(),_(k,{key:1,type:"primary",status:"danger",style:{"background-color":"rgb(203, 49, 128)"},size:"mini"},{default:e(()=>[r(i(p.id),1)]),_:2},1024)):h("",!0),p.type===C[2]?(m(),_(k,{key:2,type:"primary",status:"warning",style:{"background-color":"rgb(234, 184, 84)"},size:"mini"},{default:e(()=>[r(i(p.id),1)]),_:2},1024)):h("",!0),p.type===C[3]?(m(),_(k,{key:3,type:"primary",size:"mini",style:{"background-color":"rgb(26, 26, 26)"}},{default:e(()=>[r(i(p.id),1)]),_:2},1024)):h("",!0)]),show:e(({record:p})=>[o(ie,{size:"small","default-checked":p.show==1,"checked-value":1,"unchecked-value":0,onChange:P=>j(p)},null,8,["default-checked","onChange"])]),address:e(({record:p})=>[M("span",{style:Ee(p.available_status==0?"color: red":p.available_status==1?"color:#faad14":"color: green")},"\u25CF",4),r(" "+i(p.host),1),co,r(i(p.port),1)]),online:e(({record:p})=>[o(ce),r(" "+i(p.online==null?0:p.online),1)]),rate:e(({record:p})=>[o(ee,{bordered:""},{default:e(()=>[r(i(p.rate)+" X",1)]),_:2},1024)]),group_id:e(({record:p})=>[o(Z,{wrap:""},{default:e(()=>[(m(!0),z(R,null,q(p.group_id,(P,ke)=>(m(),_(ee,{key:ke,bordered:""},{default:e(()=>[r(i(a($)[P]?a($)[P]:a(y)("nodeTable.unknown")),1)]),_:2},1024))),128))]),_:2},1024)]),operations:e(({record:p})=>[o(Y,{"popup-max-height":!1},{content:e(()=>[o(S,null,{default:e(()=>[o(k,{type:"text",onClick:P=>V(p),status:"success"},{default:e(()=>[o(_e),r(" "+i(a(y)("nodeTable.operations.edit")),1)]),_:2},1032,["onClick"])]),_:2},1024),o(S,null,{default:e(()=>[o(k,{onClick:P=>F(p),type:"text",status:"warning"},{default:e(()=>[o(be),r(" "+i(a(y)("nodeTable.operations.copy")),1)]),_:2},1032,["onClick"])]),_:2},1024),o(S,null,{default:e(()=>[o(k,{onClick:P=>X(p),type:"text",status:"danger"},{default:e(()=>[o(ye),r(" "+i(a(y)("nodeTable.operations.delete")),1)]),_:2},1032,["onClick"])]),_:2},1024)]),default:e(()=>[o(k,{type:"text"},{default:e(()=>[r(i(a(y)("nodeTable.operations.button"))+" ",1),o(fe)]),_:1})]),_:2},1024)]),_:1},8,["loading","pagination","columns","data","size"])]),_:1}),o(ge,{"unmount-on-close":!0,footer:!1,width:500,visible:v.value,onOk:u[4]||(u[4]=()=>{v.value=!1}),"ok-text":a(y)("nodeTable.drawer.ok"),"cancel-text":a(y)("nodeTable.drawer.cancel"),onCancel:u[5]||(u[5]=()=>{v.value=!1})},{title:e(()=>[r(i(a(y)("nodeTable.drawer.title")),1)]),default:e(()=>[o(uo,{parentServer:b.value,"channel-type":n.channelType,data:B.value,onClose:f},null,8,["parentServer","channel-type","data"])]),_:1},8,["visible","ok-text","cancel-text"])])}}});const Bo=Ce(_o,[["__scopeId","data-v-608eb392"]]);export{Bo as default};
