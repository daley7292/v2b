import{v as W,E as K,_ as ge}from"./index.931e29e8.js";/* empty css               *//* empty css              *//* empty css               *//* empty css              *//* empty css              *//* empty css                *//* empty css              *//* empty css               *//* empty css               *//* empty css               *//* empty css               */import{d as X,f as v,r as N,C as i,D as c,aI as n,aH as e,u as t,aK as xe,aJ as Ce,aM as r,aN as s,aW as M,b2 as De,b7 as re,bB as we,bC as $e,aX as ie,b3 as de,b5 as ue,aZ as _e,aE as x,aF as u,c as Ie,o as Ve,w as Se,G as R,bP as qe,F as Fe,ah as Oe,a6 as ze,bQ as Ne,I as Te,be as Pe,b4 as Ee,bE as Me,b6 as Be,aY as Qe,bz as Ue,bc as Ae,bd as je}from"./arco.d070d3bc.js";import{d as L,S as Le,_ as Je,O as Ge,C as He,P as Ke,a as se,Q as Re}from"./order.a7a83fb5.js";import{u as We}from"./loading.50473042.js";import{c as ne}from"./cloneDeep.47777689.js";/* empty css               *//* empty css               */import{Q as Xe}from"./subscription.ae1f303c.js";import{Q as Ye}from"./user.68bd3115.js";import{f as le}from"./vue.02dbc53f.js";import"./chart.dd5d83bb.js";/* empty css              *//* empty css                */const Ze=X({__name:"order-form",props:["data"],emits:["close"],setup(V,{emit:o}){const{t:l}=W.exports.useI18n(),f=v([]),D=()=>{o("close"),Object.keys(m).forEach(p=>{m[p]=void 0})},m=N(L),O=N({}),B=()=>{Object.keys(m).forEach(p=>{O[p]=m[p]}),O.total_amount=m.total_amount*100,Le(O).then(p=>{p.data&&(M.success("\u63D0\u4EA4\u6210\u529F"),D())})};return(()=>{Xe().then(p=>{f.value=p.data})})(),(p,h)=>{const T=De,S=re,b=we,Q=$e,U=ie,J=de,G=ue;return i(),c("div",null,[n(G,{layout:"vertical",ref:"order",model:m,onSubmit:B},{default:e(()=>[n(S,{field:"name",label:t(l)("order.form.email")},{default:e(()=>[n(T,{modelValue:m.email,"onUpdate:modelValue":h[0]||(h[0]=k=>m.email=k),placeholder:t(l)("order.form.email.placeholder")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),n(S,{field:"plan_id",label:t(l)("order.form.subscription")},{default:e(()=>[n(Q,{modelValue:m.plan_id,"onUpdate:modelValue":h[1]||(h[1]=k=>m.plan_id=k)},{default:e(()=>[(i(!0),c(xe,null,Ce(f.value,(k,H)=>(i(),c("div",{key:H},[n(b,{value:k.id},{default:e(()=>[r(s(k.name),1)]),_:2},1032,["value"])]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),n(S,{field:"period",label:t(l)("order.form.reset_method")},{default:e(()=>[n(Q,{placeholder:t(l)("order.form.period"),modelValue:m.period,"onUpdate:modelValue":h[2]||(h[2]=k=>m.period=k)},{default:e(()=>[n(b,{value:"month_price"},{default:e(()=>[r(s(t(l)("order.period.month")),1)]),_:1}),n(b,{value:"quarter_price"},{default:e(()=>[r(s(t(l)("order.period.quarter")),1)]),_:1}),n(b,{value:"half_year_price"},{default:e(()=>[r(s(t(l)("order.period.half_year")),1)]),_:1}),n(b,{value:"year_price"},{default:e(()=>[r(s(t(l)("order.period.year")),1)]),_:1}),n(b,{value:"two_year_price"},{default:e(()=>[r(s(t(l)("order.period.two_year")),1)]),_:1}),n(b,{value:"three_year_price"},{default:e(()=>[r(s(t(l)("order.period.three_year")),1)]),_:1}),n(b,{value:"onetime_price"},{default:e(()=>[r(s(t(l)("order.period.onetime")),1)]),_:1}),n(b,{value:"reset_price"},{default:e(()=>[r(s(t(l)("order.period.reset")),1)]),_:1})]),_:1},8,["placeholder","modelValue"])]),_:1},8,["label"]),n(S,{field:"name",label:t(l)("order.form.amount")},{default:e(()=>[n(T,{placeholder:t(l)("order.form.amount.placeholder"),modelValue:m.total_amount,"onUpdate:modelValue":h[3]||(h[3]=k=>m.total_amount=k),"allow-clear":""},{append:e(()=>[r(" \uFFE5 ")]),_:1},8,["placeholder","modelValue"])]),_:1},8,["label"]),n(S,null,{default:e(()=>[n(J,null,{default:e(()=>[n(U,{type:"dashed",onClick:D},{default:e(()=>[r(s(t(l)("button.cancel")),1)]),_:1}),n(U,{type:"primary","html-type":"submit"},{default:e(()=>[r(s(t(l)("order.form.submit")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])])}}}),et={key:0},tt={key:1},at={key:2},ot={key:3},st={key:4},nt={key:5},lt={key:6},rt={key:7},it={key:0},dt={key:1},ut={key:2},_t={key:3},mt=X({__name:"order-detail",props:["data","details","order"],setup(V){const o=V,{t:l}=W.exports.useI18n(),f=N(o.data),D=N(o.order),m=N(o.details);return(O,B)=>{const w=_e("router-link"),p=re,h=ue;return i(),x(h,{model:f},{default:e(()=>[n(p,{label:t(l)("orderDetail.label.email")},{default:e(()=>[n(w,{to:`/user/manager?email=${m==null?void 0:m.email}`},{default:e(()=>[r(s(m==null?void 0:m.email),1)]),_:1},8,["to"])]),_:1},8,["label"]),n(p,{label:t(l)("orderDetail.label.trade_no")},{default:e(()=>[r(s(f.trade_no),1)]),_:1},8,["label"]),n(p,{label:t(l)("orderDetail.label.period")},{default:e(()=>[f.period==="month_price"?(i(),c("span",et,s(t(l)("order.period.month")),1)):u("",!0),f.period==="quarter_price"?(i(),c("span",tt,s(t(l)("order.period.quarter")),1)):u("",!0),f.period==="half_year_price"?(i(),c("span",at,s(t(l)("order.period.half_year")),1)):u("",!0),f.period==="year_price"?(i(),c("span",ot,s(t(l)("order.period.year")),1)):u("",!0),f.period==="two_year_price"?(i(),c("span",st,s(t(l)("order.period.two_year")),1)):u("",!0),f.period==="three_year_price"?(i(),c("span",nt,s(t(l)("order.period.three_year")),1)):u("",!0),f.period==="onetime_price"?(i(),c("span",lt,s(t(l)("order.period.onetime")),1)):u("",!0),f.period==="reset_price"?(i(),c("span",rt,s(t(l)("order.period.reset")),1)):u("",!0)]),_:1},8,["label"]),n(p,{label:t(l)("orderDetail.label.status")},{default:e(()=>[f.status==0?(i(),c("span",it,s(t(l)("order.status.pending")),1)):u("",!0),f.status==1?(i(),c("span",dt,s(t(l)("order.status.paid")),1)):u("",!0),f.status==2?(i(),c("span",ut,s(t(l)("order.status.cancelled")),1)):u("",!0),f.status===3?(i(),c("span",_t,s(t(l)("order.status.completed")),1)):u("",!0)]),_:1},8,["label"]),n(p,{label:t(l)("orderDetail.label.plan_name")},{default:e(()=>[r(s(D.plan_name),1)]),_:1},8,["label"]),n(p,{label:t(l)("orderDetail.label.callback_no")},{default:e(()=>[r(s(f.callback_no===null?"-":f.callback_no),1)]),_:1},8,["label"]),n(p,{label:t(l)("orderDetail.label.total_amount")},{default:e(()=>[r(s(f.total_amount/100),1)]),_:1},8,["label"]),n(p,{label:t(l)("orderDetail.label.balance_amount")},{default:e(()=>[r(s(f.balance_amount/100),1)]),_:1},8,["label"]),n(p,{label:t(l)("orderDetail.label.discount_amount")},{default:e(()=>[r(s(f.discount_amount/100),1)]),_:1},8,["label"]),n(p,{label:t(l)("orderDetail.label.refund_amount")},{default:e(()=>[r(s(f.refund_amount/100),1)]),_:1},8,["label"]),n(p,{label:t(l)("orderDetail.label.surplus_amount")},{default:e(()=>[r(s(f.surplus_amount/100),1)]),_:1},8,["label"]),m.invite_user&&m.invite_user.email?(i(),x(p,{key:0,label:t(l)("orderDetail.label.invite_user")},{default:e(()=>[n(w,{to:`/user/manager?invite_by_email=${m.invite_user.email}`},{default:e(()=>[r(s(m.invite_user.email),1)]),_:1},8,["to"])]),_:1},8,["label"])):u("",!0),n(p,{label:t(l)("orderDetail.label.created_at")},{default:e(()=>[r(s(t(K)(f.created_at)),1)]),_:1},8,["label"]),n(p,{label:t(l)("orderDetail.label.updated_at")},{default:e(()=>[r(s(t(K)(f.updated_at)),1)]),_:1},8,["label"])]),_:1},8,["model"])}}}),ct=V=>(Ae("data-v-d256c082"),V=V(),je(),V),pt={class:"container"},ft={style:{"margin-bottom":"15px"}},yt=ct(()=>R("span",{class:"dot-red"},"\u2022",-1)),bt={key:0,style:{"padding-left":"16px"}},vt={key:0,style:{"padding-left":"16px"}},ht={key:0,style:{"padding-left":"16px"}},kt={key:0,style:{"padding-left":"16px"}},gt={key:0},xt={key:1},Ct={key:0},Dt={key:1},wt={key:2},$t={key:3},It={key:4},Vt={key:5},St={key:6},qt={key:7},Ft={key:8},Ot={name:"ServerNode"},zt=X({...Ot,setup(V){const{t:o}=W.exports.useI18n(),l=v(!1),f=v([{key:"trade_no",des:o("order.filter.trade_no"),op:[o("order.filter.fuzzy")],type:"input",value:""},{key:"status",des:o("order.filter.status"),op:["=",">",">=","<","<="],type:"select",value:[{des:o("order.filter.status.pending"),value:"0"},{des:o("order.filter.status.paid"),value:1},{des:o("order.filter.status.cancelled"),value:2},{des:o("order.filter.status.completed"),value:3}]},{key:"commission_status",des:o("order.filter.commission_status"),op:["="],type:"select",value:[{des:o("order.filter.commission.pending"),value:0},{des:o("order.filter.commission.processing"),value:1},{des:o("order.filter.commission.paid"),value:2},{des:o("order.filter.commission.invalid"),value:3}]},{key:"user_id",des:o("order.filter.user_id"),op:["=",">",">=","<","<="],type:"input",value:""},{key:"invite_user_id",des:o("order.filter.invite_user_id"),op:["=","!="],type:"input",value:""},{key:"callback_no",des:o("order.filter.callback_no"),op:[o("order.filter.fuzzy")],type:"input",value:""},{key:"commission_balance",des:o("order.filter.commission_balance"),op:["=","!=",">",">=","<","<="],type:"input",value:""}]);le();const D=v([]),m=v(),O=d=>{m.value=d,ee(1),l.value=!1},B=d=>{if(d===void 0||d===0||d==null)return"---";const _=d*24*60,C=Math.floor(_/(24*60)),j=Math.floor(_%(24*60)/60),y=(_%60).toFixed(0);let z="";return C>0&&(z+=`${C}\u5929`),j>0&&(z+=`${j}\u5C0F\u65F6`),y>0&&(z+=`${y}\u5206\u949F`),z},w=v(!1),p=v(L),h=v(),T=v(),S=()=>{w.value=!1,$()},b=v(!1),Q=d=>{h.value=d,Ge({id:d.id}).then(_=>{p.value=_.data,Ye({id:_.data.user_id}).then(C=>{T.value=C.data,b.value=!0})})},U=d=>{He({trade_no:d.trade_no}).then(_=>{_.data&&(M.success({content:o("order.button.cancel_success")}),$())})},J=d=>{Ke({trade_no:d.trade_no}).then(_=>{_.data&&(M.success({content:o("order.button.confirm_payment")}),$())})},G=d=>{se({trade_no:d.trade_no,commission_status:3}).then(_=>{_.data&&(M.success({content:o("order.commission.invalid")}),$())})},k=(d,_)=>{se({trade_no:d.trade_no,commission_status:_}).then(C=>{C.data&&(M.success({content:o("order.commission.valid")}),$())})},H=d=>d.length>6?`${d.substring(0,3)}...${d.substring(d.length-3,d.length)}`:d,{loading:me,setLoading:Y}=We(!0),Z=v([]),A=v([]),ce=v([]),pe=v("medium"),P={current:1,pageSize:100},q=N({...P,showTotal:!0,showJumper:!0,showPageSize:!0,pageSizeOptions:[100,500,1e3]}),fe=d=>{q.pageSize=d,P.pageSize=d,$({...P,pageSize:d})},ye=Ie(()=>[{title:o("orderTable.columns.trade_no"),dataIndex:"trade_no",slotName:"trade_no"},{title:o("orderTable.columns.type"),dataIndex:"type",slotName:"type"},{title:o("orderTable.columns.plan_name"),dataIndex:"plan_name",slotName:"plan_name"},{title:o("orderTable.columns.period"),dataIndex:"period",slotName:"period"},{title:o("orderTable.columns.gift_days"),dataIndex:"gift_days",slotName:"gift_days"},{title:o("orderTable.columns.total_amount"),dataIndex:"total_amount",slotName:"total_amount"},{title:o("orderTable.columns.status"),dataIndex:"status",slotName:"status"},{title:o("orderTable.columns.commission_balance"),dataIndex:"commission_balance",slotName:"commission_balance"},{title:o("orderTable.columns.commission_status"),dataIndex:"commission_status",slotName:"commission_status"},{title:o("orderTable.columns.created_at"),dataIndex:"created_at",slotName:"created_at"}]),$=async d=>{d||(d={...q}),Y(!0);try{const{data:_,total:C}=await Re(d,m.value);Z.value=_,q.total=C,q.current=d.current}catch{}finally{Y(!1)}},ee=d=>{$({...P,current:d})},g=le();return Ve(()=>{g.query.id&&(m.value={filter:[{key:"user_id",condition:"=",value:g.query.id,tempValue:""}]},D.value.push({key:"user_id",condition:"=",value:g.query.id,tempValue:""})),g.query.status&&(m.value={filter:[{key:"status",condition:"=",value:g.query.status,tempValue:""}]},D.value.push({key:"status",condition:"=",value:g.query.status,tempValue:""})),g.query.commission_status&&(m.value={filter:[{key:"commission_status",condition:"=",value:g.query.commission_status,tempValue:""}]},D.value.push({key:"commission_status",condition:"=",value:g.query.commission_status,tempValue:""})),g.query.trade_no&&(m.value={filter:[{key:"trade_no",condition:"=",value:g.query.trade_no,tempValue:""}]},D.value.push({key:"trade_no",condition:"=",value:g.query.trade_no,tempValue:""})),$(P)}),Se(()=>ye.value,d=>{A.value=ne(d),A.value.forEach((_,C)=>{_.checked=!0}),ce.value=ne(A.value)},{deep:!0,immediate:!0}),(d,_)=>{const C=_e("Breadcrumb"),j=Oe,y=ie,z=ze,be=de,I=Ne,te=Te,F=Pe,ae=Ee,ve=Me,he=Be,ke=Qe,oe=Ue;return i(),c("div",pt,[n(C,{items:["menu.finance","menu.finance.order"]},null,8,["items"]),n(he,null,{default:e(()=>[R("div",ft,[n(be,null,{default:e(()=>[n(y,{type:"outline",onClick:_[0]||(_[0]=()=>l.value=!0)},{default:e(()=>[n(j)]),_:1}),n(y,{type:"outline",onClick:_[1]||(_[1]=()=>{w.value=!0,p.value=t(L)})},{icon:e(()=>[n(z)]),default:e(()=>[r(" "+s(t(o)("order.button.add")),1)]),_:1})]),_:1})]),n(ve,{"row-key":"id",loading:t(me),pagination:q,columns:A.value,data:Z.value,bordered:!1,size:pe.value,onPageChange:ee,onPageSizeChange:fe},{index:e(({rowIndex:a})=>[r(s(a+1+(q.current-1)*q.pageSize),1)]),total_amount:e(({record:a})=>[r(s((a.total_amount/100).toFixed(2)),1)]),status:e(({record:a})=>[a.status===0?(i(),x(ae,{key:0,"popup-max-height":!1},{content:e(()=>[a.status===0?(i(),x(F,{key:0},{default:e(()=>[n(y,{type:"text",onClick:E=>J(a),status:"success"},{default:e(()=>[r(s(t(o)("order.status.paid")),1)]),_:2},1032,["onClick"])]),_:2},1024)):u("",!0),a.status===0?(i(),x(F,{key:1},{default:e(()=>[n(y,{type:"text",onClick:E=>U(a),status:"danger"},{default:e(()=>[r(s(t(o)("order.status.cancel")),1)]),_:2},1032,["onClick"])]),_:2},1024)):u("",!0)]),default:e(()=>[n(y,{size:"small",type:"text"},{default:e(()=>[n(I,{type:"secondary"},{default:e(()=>[yt,r(s(t(o)("order.status.pending"))+" ",1),n(I,{type:"primary"},{default:e(()=>[r(s(t(o)("order.status.marking")),1)]),_:1})]),_:1}),n(te)]),_:1})]),_:2},1024)):u("",!0),n(I,{type:"success"},{default:e(()=>[a.status==1?(i(),c("li",bt,s(t(o)("order.status.processing")),1)):u("",!0)]),_:2},1024),n(I,{type:"secondary"},{default:e(()=>[a.status==2?(i(),c("li",vt,s(t(o)("order.status.cancelled")),1)):u("",!0)]),_:2},1024),n(I,{type:"success"},{default:e(()=>[a.status==3?(i(),c("li",ht,s(t(o)("order.status.completed")),1)):u("",!0)]),_:2},1024),n(I,{type:"success"},{default:e(()=>[a.status==4?(i(),c("li",kt,s(t(o)("order.status.discounted")),1)):u("",!0)]),_:2},1024)]),commission_status:e(({record:a})=>[n(ae,{"popup-max-height":!1},qe({default:e(()=>[n(y,{size:"small",type:"text"},{default:e(()=>[n(I,{type:"secondary"},{default:e(()=>[a.commission_balance>0&&a.status!=2&&a.status!=0?(i(),c("span",gt,[R("span",{style:Fe(a.commission_status==1?"color:#1890ff":a.commission_status==2?"color:green":"")},"\u2022",4),r(" "+s(a.commission_status==0?t(o)("order.commission.pending"):a.commission_status==1?t(o)("order.commission.processing"):a.commission_status==2?"\u5DF2\u53D1\u653E":a.commission_status===3?"\u5DF2\u9A73\u56DE":"-"),1)])):(i(),c("span",xt,"-")),(a.commission_status===0||a.commission_status===1||a.commission_status===3)&&a.status!=0&&a.commission_balance>0&&a.status!=2?(i(),x(I,{key:2,type:"primary"},{default:e(()=>[r(" \xA0"+s(t(o)("order.status.marking")),1)]),_:1})):u("",!0)]),_:2},1024),(a.commission_status===0||a.commission_status===1||a.commission_status===3)&&a.status!=0&&a.commission_balance>0&&a.status!=2?(i(),x(te,{key:0})):u("",!0)]),_:2},1024)]),_:2},[a.commission_balance>0&&a.status!=2&&a.status!=0?{name:"content",fn:e(()=>[a.commission_status===0&&a.commission_balance>0?(i(),x(F,{key:0},{default:e(()=>[n(y,{type:"text",disabled:""},{default:e(()=>[r(s(t(o)("order.commission.pending")),1)]),_:1})]),_:1})):u("",!0),(a.commission_status===1||a.commission_status===3)&&a.commission_balance>0?(i(),x(F,{key:1},{default:e(()=>[n(y,{type:"text",onClick:E=>k(a,0),status:"success"},{default:e(()=>[r(s(t(o)("order.commission.pending")),1)]),_:2},1032,["onClick"])]),_:2},1024)):u("",!0),a.commission_status===1?(i(),x(F,{key:2},{default:e(()=>[n(y,{type:"text",disabled:""},{default:e(()=>[r(s(t(o)("order.commission.valid")),1)]),_:1})]),_:1})):u("",!0),a.commission_status===0||a.commission_status===3?(i(),x(F,{key:3},{default:e(()=>[n(y,{type:"text",onClick:E=>k(a,1)},{default:e(()=>[r(s(t(o)("order.commission.valid")),1)]),_:2},1032,["onClick"])]),_:2},1024)):u("",!0),a.commission_status===1||a.commission_status===0?(i(),x(F,{key:4},{default:e(()=>[n(y,{type:"text",onClick:E=>G(a),status:"danger"},{default:e(()=>[r(s(t(o)("order.commission.invalid")),1)]),_:2},1032,["onClick"])]),_:2},1024)):u("",!0)]),key:"0"}:void 0]),1024)]),commission_balance:e(({record:a})=>[r(s(a.commission_balance===null||a.commission_balance===0||a.status===2||a.status==0?t(o)("order.commission.none"):(a.commission_balance/100).toFixed(2)),1)]),gift_days:e(({record:a})=>[r(s(B(a.gift_days)),1)]),period:e(({record:a})=>[a.period==="month_price"?(i(),c("span",Ct,s(t(o)("order.period.month")),1)):u("",!0),a.period==="quarter_price"?(i(),c("span",Dt,s(t(o)("order.period.quarter")),1)):u("",!0),a.period==="half_year_price"?(i(),c("span",wt,s(t(o)("order.period.half_year")),1)):u("",!0),a.period==="year_price"?(i(),c("span",$t,s(t(o)("order.period.year")),1)):u("",!0),a.period==="two_year_price"?(i(),c("span",It,s(t(o)("order.period.two_year")),1)):u("",!0),a.period==="three_year_price"?(i(),c("span",Vt,s(t(o)("order.period.three_year")),1)):u("",!0),a.period==="onetime_price"?(i(),c("span",St,s(t(o)("order.period.onetime")),1)):u("",!0),a.period==="reset_price"?(i(),c("span",qt,s(t(o)("order.period.reset")),1)):u("",!0),a.period==="try_out"?(i(),c("span",Ft,s(t(o)("order.period.try_out")),1)):u("",!0)]),type:e(({record:a})=>[r(s(a.type===1?t(o)("order.type.new"):a.type===2?t(o)("order.type.renew"):a.type===3?t(o)("order.type.upgrade"):a.type===4?t(o)("order.type.try_out"):a.type===5?t(o)("order.type.redeem_code"):t(o)("order.type.promotion")),1)]),trade_no:e(({record:a})=>[n(y,{onClick:E=>Q(a),type:"text"},{default:e(()=>[r(s(H(a.trade_no)),1)]),_:2},1032,["onClick"])]),created_at:e(({record:a})=>[r(s(t(K)(a.created_at)),1)]),_:1},8,["loading","pagination","columns","data","size"])]),_:1}),n(ke,{width:500,visible:w.value,footer:!1,"unmount-on-close":!0,onCancel:_[2]||(_[2]=()=>{w.value=!1})},{title:e(()=>[r(s(t(o)("order.modal.add")),1)]),default:e(()=>[n(Ze,{onClose:S})]),_:1},8,["visible"]),n(oe,{visible:b.value,"onUpdate:visible":_[3]||(_[3]=a=>b.value=a),width:"650px","unmount-on-close":!0,footer:!1,onCancel:_[4]||(_[4]=()=>{b.value=!1,p.value=t(L)})},{title:e(()=>[r(s(t(o)("order.modal.detail")),1)]),default:e(()=>[n(mt,{data:p.value,details:T.value,order:h.value},null,8,["data","details","order"])]),_:1},8,["visible"]),n(oe,{width:550,visible:l.value,footer:!1,onCancel:_[6]||(_[6]=()=>{l.value=!1})},{title:e(()=>[r(s(t(o)("order.modal.filter")),1)]),default:e(()=>[n(Je,{filter:f.value,"default-cond":D.value,onCallback:O,onCancel:_[5]||(_[5]=a=>l.value=!1)},null,8,["filter","default-cond"])]),_:1},8,["visible"])])}}});const sa=ge(zt,[["__scopeId","data-v-d256c082"]]);export{sa as default};
